<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Godot Coverage Pipeline</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

    <!-- Babel for JSX/TS transformation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        /* Custom scrollbar styles */
        .custom-scrollbar::-webkit-scrollbar {
            width: 8px;
        }

        .custom-scrollbar::-webkit-scrollbar-track {
            background: rgba(30, 41, 59, 0.5);
        }

        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: rgba(71, 85, 105, 0.8);
            border-radius: 4px;
        }

        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: rgba(100, 116, 139, 1);
        }

        /* Animations */
        @keyframes fade-in {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        @keyframes zoom-in {
            from {
                transform: scale(0.95);
            }

            to {
                transform: scale(1);
            }
        }

        @keyframes slide-in-from-bottom-2 {
            from {
                transform: translateY(0.5rem);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .animate-in {
            animation-duration: 0.2s;
            animation-fill-mode: both;
        }

        .fade-in {
            animation-name: fade-in;
        }

        .zoom-in {
            animation-name: zoom-in;
        }

        .slide-in-from-bottom-2 {
            animation-name: slide-in-from-bottom-2;
        }
    </style>
</head>

<body class="bg-slate-900 text-slate-100">
    <div id="root"></div>

    <script type="text/babel" data-presets="env,react,typescript">
        const { useState, useEffect, useRef } = React;

        // --- Icons (Replaced lucide-react imports with inline SVG components) ---
        const Icon = ({ children, size = 24, className = "", ...props }) => (
            <svg
                xmlns="http://www.w3.org/2000/svg"
                width={size}
                height={size}
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                strokeWidth="2"
                strokeLinecap="round"
                strokeLinejoin="round"
                className={className}
                {...props}
            >
                {children}
            </svg>
        );

        const Play = (props) => <Icon {...props}><polygon points="5 3 19 12 5 21 5 3" /></Icon>;
        const Square = (props) => <Icon {...props}><rect x="3" y="3" width="18" height="18" rx="2" ry="2" /></Icon>;
        const Cpu = (props) => <Icon {...props}><rect x="4" y="4" width="16" height="16" rx="2" ry="2" /><rect x="9" y="9" width="6" height="6" /><path d="M9 1v3" /><path d="M15 1v3" /><path d="M9 20v3" /><path d="M15 20v3" /><path d="M20 9h3" /><path d="M20 14h3" /><path d="M1 9h3" /><path d="M1 14h3" /></Icon>;
        const ArrowRight = (props) => <Icon {...props}><path d="M5 12h14" /><path d="m12 5 7 7-7 7" /></Icon>;
        const Info = (props) => <Icon {...props}><circle cx="12" cy="12" r="10" /><path d="M12 16v-4" /><path d="M12 8h.01" /></Icon>;
        const BookOpen = (props) => <Icon {...props}><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z" /><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z" /></Icon>;
        const FileCode = (props) => <Icon {...props}><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z" /><polyline points="14 2 14 8 20 8" /><path d="m10 13-2 2 2 2" /><path d="m14 17 2-2-2-2" /></Icon>;
        const Search = (props) => <Icon {...props}><circle cx="11" cy="11" r="8" /><path d="m21 21-4.3-4.3" /></Icon>;
        const Database = (props) => <Icon {...props}><ellipse cx="12" cy="5" rx="9" ry="3" /><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3" /><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5" /></Icon>;
        const FileText = (props) => <Icon {...props}><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z" /><polyline points="14 2 14 8 20 8" /><line x1="16" y1="13" x2="8" y2="13" /><line x1="16" y1="17" x2="8" y2="17" /><line x1="10" y1="9" x2="8" y2="9" /></Icon>;
        const Layers = (props) => <Icon {...props}><polygon points="12 2 2 7 12 12 22 7 12 2" /><polyline points="2 17 12 22 22 17" /><polyline points="2 12 12 17 22 12" /></Icon>;


        // --- Main Application Code ---
        const CoverageSimulator = () => {
            const [isRunning, setIsRunning] = useState(false);
            const [currentLine, setCurrentLine] = useState(null);
            const [scanLine, setScanLine] = useState(null);
            const [coverageData, setCoverageData] = useState({});
            const [totalCoverable, setTotalCoverable] = useState(0);
            const [stepPhase, setStepPhase] = useState('idle');
            const [speed, setSpeed] = useState(1000);
            const [aggregationProgress, setAggregationProgress] = useState(0);
            const [selectedInfo, setSelectedInfo] = useState('intro');

            const seqIndexRef = useRef(0);

            // Mock GDScript Code
            const codeLines = [
                { line: 1, text: "extends Node", type: "decl" },
                { line: 3, text: "var health = 100", type: "decl" },
                { line: 5, text: "func _process(delta):", type: "func" },
                { line: 6, text: "    if health > 0:", type: "logic" },
                { line: 7, text: "        update_world()", type: "logic" },
                { line: 11, text: "func update_world():", type: "func" },
                { line: 12, text: "    print('Running')", type: "logic" },
            ];

            // Didactic Info Content
            const infoContent = {
                intro: {
                    title: "Interactive Diagram: Runtime Interception",
                    cppClass: "Simulation Control",
                    desc: "Click 'Start Sim' to visualize how the C++ GDExtension interacts with the Godot VM. Select the (i) icons on each card to learn about the specific engine subsystems involved."
                },
                source: {
                    title: "Step 1: Static Analysis",
                    cppClass: "modules/gdscript/gdscript_parser.cpp",
                    desc: "To calculate coverage percentage, we first need a 'Denominator' (Total Lines). On startup, the extension uses Godot's internal Parser to walk the script's AST (Abstract Syntax Tree). It identifies lines that contain actual logic, skipping comments, whitespace, and variable declarations."
                },
                vm: {
                    title: "Step 2: The Virtual Machine",
                    cppClass: "modules/gdscript/gdscript_vm.cpp",
                    desc: "The VM is the heart of Godot. Normally, it runs opcodes as fast as possible. However, our extension registers itself as a 'Profiler'. This signals the VM to check for hooks before every instruction. When the VM reaches a new line, it momentarily pauses to notify our extension."
                },
                extension: {
                    title: "Step 3: The Interceptor (GDExtension)",
                    cppClass: "core/debugger/script_debugger.cpp",
                    desc: "This is our custom C++ code. We use `ScriptDebugger::set_lines_left(1)` to enforce line-by-line stepping. When the VM calls our `add_frame()` callback, we capture the Script Path and Line Number, incrementing a counter in a high-performance C++ HashMap."
                },
                report: {
                    title: "Step 4: LCOV Report Generation",
                    cppClass: "core/io/file_access.cpp",
                    desc: "When the game exits, the extension serializes the in-memory data into the LCOV format. This is the industry standard for C/C++ coverage, allowing the output `lcov.info` file to be immediately read by tools like SonarQube, Jenkins, or VS Code extensions."
                }
            };

            const activeInfo = infoContent[selectedInfo];

            useEffect(() => {
                let interval;
                let timeouts = [];

                const isAnalyzing = stepPhase === 'analyzing';
                const isAggregating = stepPhase === 'aggregating';

                if (isRunning) {
                    if (isAnalyzing) {
                        let currentScanIdx = 0;
                        let foundCoverable = 0;

                        interval = setInterval(() => {
                            if (currentScanIdx >= codeLines.length) {
                                setTotalCoverable(foundCoverable);
                                setScanLine(null);
                                setStepPhase('executing');
                                return;
                            }

                            const lineObj = codeLines[currentScanIdx];
                            setScanLine(lineObj.line);
                            if (lineObj.type === 'logic' || lineObj.type === 'func') {
                                foundCoverable++;
                            }
                            currentScanIdx++;
                        }, 300);
                    }
                    else if (!isAggregating && stepPhase !== 'reporting') {
                        const sequence = [5, 6, 7, 11, 12];

                        interval = setInterval(() => {
                            setStepPhase('executing');
                            const lineToHit = sequence[seqIndexRef.current];
                            setCurrentLine(lineToHit);

                            const t1 = setTimeout(() => {
                                setStepPhase('intercepting');
                                const t2 = setTimeout(() => {
                                    setStepPhase('recording');
                                    setCoverageData(prev => ({
                                        ...prev,
                                        [lineToHit]: (prev[lineToHit] || 0) + 1
                                    }));
                                    seqIndexRef.current = (seqIndexRef.current + 1) % sequence.length;
                                }, speed * 0.3);
                                timeouts.push(t2);
                            }, speed * 0.3);
                            timeouts.push(t1);

                        }, speed);
                    }
                } else {
                    if (stepPhase === 'aggregating') {
                        interval = setInterval(() => {
                            setAggregationProgress(prev => {
                                if (prev >= 100) {
                                    setStepPhase('reporting');
                                    return 100;
                                }
                                return prev + 5;
                            });
                        }, 50);
                    }
                }

                return () => {
                    clearInterval(interval);
                    timeouts.forEach(clearTimeout);
                };
            }, [isRunning, speed, stepPhase]);

            const handleStart = () => {
                setIsRunning(true);
                setCoverageData({});
                setAggregationProgress(0);
                seqIndexRef.current = 0;
                setStepPhase('analyzing');
                setSelectedInfo('source');
            };

            const handleStop = () => {
                setIsRunning(false);
                setCurrentLine(null);
                setScanLine(null);
                setStepPhase('aggregating');
                setSelectedInfo('report');
            };

            const generateLCOV = () => {
                const executedLines = Object.keys(coverageData).length;
                let lcov = "TN:\nSF:res://player.gd\n";
                codeLines.forEach(l => {
                    if (l.type === 'logic' || l.type === 'func') {
                        const hits = coverageData[l.line] || 0;
                        lcov += `DA:${l.line},${hits}\n`;
                    }
                });
                lcov += `LF:${totalCoverable}\n`;
                lcov += `LH:${executedLines}\n`;
                lcov += "end_of_record";
                return lcov;
            };

            return (
                <div className="min-h-screen bg-slate-900 text-slate-100 font-sans selection:bg-blue-500/30">
                    <div className="max-w-7xl mx-auto p-6 flex flex-col gap-6">

                        {/* 1. HEADER & CONTROLS */}
                        <div className="flex justify-between items-start border-b border-slate-700 pb-6">
                            <div>
                                <h1 className="text-2xl font-bold text-blue-400 flex items-center gap-2">
                                    <Cpu className="w-8 h-8" />
                                    Godot Coverage Pipeline
                                </h1>
                                <p className="text-slate-400 text-sm mt-2 max-w-2xl leading-relaxed">
                                    A visualization of the <span className="text-slate-200 font-semibold">C++ GDExtension Architecture</span>.
                                    This approach uses Runtime Interception to capture coverage without modifying source code.
                                </p>
                            </div>
                            <div className="flex items-center gap-6 bg-slate-800 p-3 rounded-lg border border-slate-700">
                                <div className="flex flex-col gap-1">
                                    <div className="text-[10px] uppercase font-bold text-slate-500 tracking-wider">Simulation Speed</div>
                                    <input type="range" min="500" max="2000" step="100" value={speed}
                                        onChange={(e) => setSpeed(Number(e.target.value))}
                                        className="w-32 accent-blue-500 cursor-pointer"
                                    />
                                </div>
                                <div className="h-8 w-px bg-slate-600"></div>
                                {!isRunning ? (
                                    <button onClick={handleStart}
                                        className="flex items-center gap-2 px-6 py-2 bg-green-600 hover:bg-green-500 rounded font-bold shadow-lg shadow-green-900/20 transition-all active:scale-95 text-sm">
                                        <Play size={18} /> Start Sim
                                    </button>
                                ) : (
                                    <button onClick={handleStop}
                                        className="flex items-center gap-2 px-6 py-2 bg-red-600 hover:bg-red-500 rounded font-bold shadow-lg shadow-red-900/20 transition-all active:scale-95 text-sm">
                                        <Square size={18} /> Stop & Report
                                    </button>
                                )}
                            </div>
                        </div>

                        {/* 2. MAIN PIPELINE (Compact Height) */}
                        <div className="grid grid-cols-4 gap-4 relative">

                            {/* STEP 1: SOURCE */}
                            <div className={`h-80 rounded-xl border flex flex-col relative transition-all duration-500 bg-slate-950 ${stepPhase === 'analyzing' ? 'border-yellow-500 ring-2 ring-yellow-500/20' : 'border-slate-800'}`}>
                                <div className="p-3 border-b border-slate-800 flex justify-between items-center bg-slate-900/50 rounded-t-xl backdrop-blur-sm">
                                    <div className="text-xs font-bold text-slate-300 uppercase tracking-wider flex items-center gap-2">
                                        <FileCode size={14} className="text-slate-500" /> 1. Source Code
                                    </div>
                                    <button onClick={() => setSelectedInfo('source')} className={`p-1.5 rounded-full hover:bg-slate-800 transition-colors ${selectedInfo === 'source' ? 'text-blue-400 bg-blue-900/20' : 'text-slate-500'}`}>
                                        <Info size={16} />
                                    </button>
                                </div>
                                <div className="p-4 font-mono text-xs leading-7 overflow-y-auto flex-grow custom-scrollbar">
                                    {codeLines.map((line) => {
                                        const isScanning = scanLine === line.line;
                                        const isExec = currentLine === line.line;
                                        const isCoverable = (line.type === 'logic' || line.type === 'func');
                                        return (
                                            <div key={line.line} className={`px-2 rounded transition-all duration-200 relative ${isScanning ? 'bg-yellow-900/40 text-yellow-200' : ''} ${isExec ? 'bg-blue-900/30 text-blue-200 border-l-2 border-blue-500' : 'text-slate-500 border-l-2 border-transparent'}`}>
                                                {isCoverable && stepPhase !== 'analyzing' && totalCoverable > 0 && (
                                                    <div className="absolute right-2 top-1/2 -translate-y-1/2 w-1.5 h-1.5 rounded-full bg-slate-700"></div>
                                                )}
                                                <span className="inline-block w-6 opacity-50 select-none">{line.line}</span>
                                                {line.text}
                                            </div>
                                        );
                                    })}
                                </div>
                                {stepPhase === 'analyzing' && <div className="absolute bottom-0 left-0 right-0 bg-yellow-900/80 text-center text-[10px] text-yellow-200 py-1 font-bold backdrop-blur-sm rounded-b-xl">SCANNING AST...</div>}
                            </div>

                            {/* STEP 2: VM */}
                            <div className={`h-80 rounded-xl border flex flex-col relative transition-colors duration-300 bg-slate-950 ${stepPhase === 'executing' ? 'border-blue-500 ring-2 ring-blue-500/20' : 'border-slate-800'}`}>
                                <div className="p-3 border-b border-slate-800 flex justify-between items-center bg-slate-900/50 rounded-t-xl backdrop-blur-sm">
                                    <div className="text-xs font-bold text-slate-300 uppercase tracking-wider flex items-center gap-2">
                                        <Cpu size={14} className="text-slate-500" /> 2. Engine VM
                                    </div>
                                    <button onClick={() => setSelectedInfo('vm')} className={`p-1.5 rounded-full hover:bg-slate-800 transition-colors ${selectedInfo === 'vm' ? 'text-blue-400 bg-blue-900/20' : 'text-slate-500'}`}>
                                        <Info size={16} />
                                    </button>
                                </div>
                                <div className="flex-grow flex flex-col items-center justify-center gap-6 text-center p-4">
                                    <Cpu size={64} className={`transition-all duration-300 ${stepPhase === 'executing' ? 'text-blue-400 drop-shadow-[0_0_15px_rgba(96,165,250,0.5)]' : 'text-slate-800'}`} />

                                    <div className="w-full min-h-[4rem] flex flex-col justify-center items-center">
                                        {(stepPhase === 'executing' || stepPhase === 'intercepting' || stepPhase === 'recording') ? (
                                            <div className="animate-in fade-in zoom-in duration-200 w-full">
                                                <div className="text-xs font-mono text-blue-200 bg-blue-950 border border-blue-900 px-3 py-2 rounded-lg shadow-lg mb-2">
                                                    OPCODE: EXEC_LINE <span className="font-bold text-white">{currentLine}</span>
                                                </div>
                                                {stepPhase !== 'executing' && (
                                                    <div className="text-[10px] font-bold text-purple-400 uppercase tracking-widest animate-pulse flex items-center justify-center gap-2">
                                                        <span className="w-2 h-2 rounded-full bg-purple-500"></span> PAUSED
                                                    </div>
                                                )}
                                            </div>
                                        ) : (
                                            <div className="text-xs text-slate-600 italic">Idle / Waiting</div>
                                        )}
                                    </div>
                                </div>
                            </div>

                            {/* STEP 3: EXTENSION */}
                            <div className={`h-80 rounded-xl border flex flex-col relative transition-colors duration-300 bg-slate-950 ${stepPhase === 'recording' ? 'border-purple-500 ring-2 ring-purple-500/20' : 'border-slate-800'}`}>
                                <div className="p-3 border-b border-slate-800 flex justify-between items-center bg-slate-900/50 rounded-t-xl backdrop-blur-sm">
                                    <div className="text-xs font-bold text-slate-300 uppercase tracking-wider flex items-center gap-2">
                                        <Database size={14} className="text-slate-500" /> 3. GDExtension
                                    </div>
                                    <button onClick={() => setSelectedInfo('extension')} className={`p-1.5 rounded-full hover:bg-slate-800 transition-colors ${selectedInfo === 'extension' ? 'text-blue-400 bg-blue-900/20' : 'text-slate-500'}`}>
                                        <Info size={16} />
                                    </button>
                                </div>

                                <div className="flex-grow p-4 flex flex-col gap-2 overflow-hidden">
                                    <div className="text-[10px] uppercase text-slate-500 font-bold mb-1 flex justify-between">
                                        <span>In-Memory HashMap</span>
                                        <span className="text-slate-600">RAM</span>
                                    </div>
                                    <div className="bg-black/50 rounded-lg p-3 font-mono text-xs flex-grow overflow-y-auto border border-slate-800/50 custom-scrollbar">
                                        {Object.keys(coverageData).length === 0 ? (
                                            <div className="h-full flex items-center justify-center text-slate-700 text-[10px] italic">No Data Captured</div>
                                        ) : (
                                            Object.entries(coverageData).map(([line, count]) => (
                                                <div key={line} className="flex justify-between text-green-400 border-b border-slate-800/50 last:border-0 py-1">
                                                    <span className="opacity-80">Line {line}</span>
                                                    <span className="font-bold text-white bg-slate-800 px-1.5 rounded text-[10px]">x{count}</span>
                                                </div>
                                            ))
                                        )}
                                    </div>
                                    {stepPhase === 'aggregating' && (
                                        <div className="mt-2 bg-slate-900 rounded p-2 border border-slate-800">
                                            <div className="text-[10px] text-green-400 font-bold mb-1 animate-pulse flex justify-between">
                                                <span>Aggregating...</span>
                                                <span>{aggregationProgress}%</span>
                                            </div>
                                            <div className="w-full bg-slate-800 h-1.5 rounded-full overflow-hidden">
                                                <div className="bg-green-500 h-full transition-all duration-75" style={{ width: `${aggregationProgress}%` }}></div>
                                            </div>
                                        </div>
                                    )}
                                </div>
                            </div>

                            {/* STEP 4: REPORT */}
                            <div className={`h-80 rounded-xl border flex flex-col relative transition-colors duration-300 bg-slate-950 ${stepPhase === 'reporting' ? 'border-green-500 ring-2 ring-green-500/20' : 'border-slate-800'}`}>
                                <div className="p-3 border-b border-slate-800 flex justify-between items-center bg-slate-900/50 rounded-t-xl backdrop-blur-sm">
                                    <div className="text-xs font-bold text-slate-300 uppercase tracking-wider flex items-center gap-2">
                                        <FileText size={14} className="text-slate-500" /> 4. LCOV Report
                                    </div>
                                    <button onClick={() => setSelectedInfo('report')} className={`p-1.5 rounded-full hover:bg-slate-800 transition-colors ${selectedInfo === 'report' ? 'text-blue-400 bg-blue-900/20' : 'text-slate-500'}`}>
                                        <Info size={16} />
                                    </button>
                                </div>

                                <div className="flex-grow p-4 flex flex-col relative">
                                    {stepPhase === 'reporting' ? (
                                        <div className="animate-in fade-in slide-in-from-bottom-2 duration-500 h-full flex flex-col">
                                            <div className="flex items-center justify-between mb-3 bg-slate-900 p-2 rounded border border-slate-800">
                                                <span className="text-[10px] text-slate-400 font-mono">res://coverage/lcov.info</span>
                                                <span className="text-[10px] bg-green-500/20 text-green-300 px-2 py-0.5 rounded font-bold border border-green-500/30">GENERATED</span>
                                            </div>
                                            <pre className="text-[10px] font-mono text-slate-400 bg-black p-3 rounded-lg border border-slate-800 flex-grow overflow-auto shadow-inner custom-scrollbar">
                                                {generateLCOV()}
                                            </pre>
                                        </div>
                                    ) : (
                                        <div className="h-full flex flex-col items-center justify-center text-slate-700 gap-3">
                                            <FileCode size={48} className="opacity-20" />
                                            <span className="text-xs font-medium">Waiting for exit...</span>
                                        </div>
                                    )}
                                </div>
                            </div>

                            {/* Arrows Layer */}
                            <div className="absolute top-1/2 left-[25%] -translate-x-1/2 -translate-y-1/2 text-slate-600 hidden md:block z-0">
                                <ArrowRight size={24} />
                            </div>
                            <div className="absolute top-1/2 left-[50%] -translate-x-1/2 -translate-y-1/2 text-slate-600 hidden md:block z-0">
                                <ArrowRight size={24} />
                            </div>
                            <div className="absolute top-1/2 left-[75%] -translate-x-1/2 -translate-y-1/2 text-slate-600 hidden md:block z-0">
                                <ArrowRight size={24} />
                            </div>
                        </div>

                        {/* 3. DETAILS PANEL */}
                        <div className="bg-slate-800 rounded-xl p-5 border border-slate-600 flex items-start gap-5 shadow-xl transition-all duration-300">
                            <div className="p-3 bg-blue-900/30 rounded-lg border border-blue-500/30 shrink-0 hidden md:block">
                                <BookOpen className="text-blue-300" size={24} />
                            </div>
                            <div className="flex-grow">
                                <div className="flex items-center gap-3 mb-2">
                                    <h3 className="text-white font-bold text-sm uppercase tracking-wider">
                                        {activeInfo.title}
                                    </h3>
                                    {selectedInfo !== 'intro' && (
                                        <span className="text-[10px] font-mono bg-slate-950 text-yellow-500 px-2 py-0.5 rounded border border-slate-700">
                                            {activeInfo.cppClass}
                                        </span>
                                    )}
                                </div>
                                <p className="text-sm text-slate-300 leading-relaxed max-w-4xl">
                                    {activeInfo.desc}
                                </p>
                            </div>
                        </div>

                        {/* 4. ARCHITECTURAL EXPLANATION */}
                        <div className="mt-8 border-t border-slate-700 pt-8 pb-12">
                            <div className="max-w-4xl">
                                <h2 className="text-xl font-bold text-white mb-4 flex items-center gap-2">
                                    <Layers className="text-purple-400" />
                                    Why use the "GDExtension Interceptor" strategy?
                                </h2>

                                <div className="space-y-4 text-slate-300 text-sm leading-7">
                                    <p>
                                        Standard code coverage tools for interpreted languages often rely on
                                        <span className="text-white font-semibold"> "Instrumentation via Source Injection"</span>
                                        â€” literally rewriting your `.gd` files to insert tracking code (e.g., `_tracker.hit(5)`).
                                        While easier to implement in a pure script, this approach is destructive, fragile, and creates "dirty" diffs that confuse version control.
                                    </p>

                                    <p>
                                        Our proposed <span className="text-blue-400 font-semibold">C++ GDExtension</span> approach takes the
                                        <span className="text-white font-semibold"> "Observability"</span> route.
                                        By hooking into the Godot Engine's `ScriptDebugger` and `EditorProfiler` subsystems, we intercept execution
                                        at the Virtual Machine level. This offers three critical advantages:
                                    </p>

                                    <ul className="grid grid-cols-1 md:grid-cols-3 gap-4 mt-4">
                                        <li className="bg-slate-800 p-4 rounded-lg border border-slate-700 hover:border-blue-500/50 transition-colors">
                                            <strong className="text-blue-300 block mb-2">1. Zero Source Modification</strong>
                                            The user's code remains byte-for-byte identical. No temporary files, no parsing errors, and line numbers in stack traces remain 100% accurate.
                                        </li>
                                        <li className="bg-slate-800 p-4 rounded-lg border border-slate-700 hover:border-blue-500/50 transition-colors">
                                            <strong className="text-blue-300 block mb-2">2. Native Performance</strong>
                                            Interception happens in compiled C++. While "stepping" adds overhead, it is significantly faster than executing GDScript function calls for every single line.
                                        </li>
                                        <li className="bg-slate-800 p-4 rounded-lg border border-slate-700 hover:border-blue-500/50 transition-colors">
                                            <strong className="text-blue-300 block mb-2">3. Core-Ready</strong>
                                            This architecture mirrors how internal tools (like the Godot Monitor) work. It is a perfect candidate for eventual merging into the Godot Engine core as a native module.
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<CoverageSimulator />);
    </script>
</body>

</html>